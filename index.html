<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Piping Wizard – 질문식 도면 생성</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#111111">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <style>
    :root { --bg:#0f0f10; --fg:#f1f1f1; --muted:#bdbdbd; --line:#e8e8e8; }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Pretendard,sans-serif}
    body{margin:0;background:var(--bg);color:var(--fg)}
    header{position:sticky;top:0;z-index:10;background:var(--bg);border-bottom:1px solid #262626;padding:10px 12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    h1{font-size:16px;margin:0 8px 0 0}
    main{display:grid;grid-template-columns:1fr;gap:10px}
    .card{background:#141416;border:1px solid #262626;border-radius:12px;padding:12px}
    label{font-size:13px}
    input,select,button{background:#1b1b1d;border:1px solid #333;color:var(--fg);padding:10px;border-radius:10px}
    input[type=number]{width:110px}
    button{cursor:pointer}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin:6px 0}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .muted{color:var(--muted);font-size:12px}
    .warn{color:#ffd36e;font-size:12px}
    .ok{color:#6eff9e;font-size:12px}
    #svg{width:100%;height:64vh;border:1px dashed #2a2a2a;border-radius:12px;background:#000}
    .titleblock{white-space:pre-line;line-height:1.2}
    .bar{display:flex;gap:8px;flex-wrap:wrap}
  </style>
</head>
<body>
<header>
  <h1>Piping Wizard</h1>
  <button id="btnGen">도면 생성</button>
  <button id="btnExport">PNG</button>
  <button id="btnPrint">PDF(인쇄)</button>
  <button id="btnReset">초기화</button>
  <span class="muted">오프라인 사용 가능</span>
</header>

<main>
  <section class="card" id="wizard">
    <div class="row">
      <label><b>① 구조</b></label>
      <label><input type="radio" name="layout" value="series" checked> 직렬</label>
      <label><input type="radio" name="layout" value="parallel"> 병렬(2라인 자동분배)</label>
    </div>

    <div class="row">
      <label><b>② 수량</b></label>
      <label>밸브 개수 <input id="countValve" type="number" min="0" value="1"></label>
      <label>트랩 개수 <input id="countTrap" type="number" min="0" value="0"></label>
      <label>배관 구간 개수 <input id="countPipe" type="number" min="1" value="2"></label>
    </div>

    <div class="row">
      <label><b>③ 총길이 & 부품 길이</b></label>
      <label>총 배관 길이(mm) <input id="totalLen" type="number" min="0" value="1000"></label>
      <label>밸브 바디 길이(mm) <input id="valveLen" type="number" min="0" value="150"></label>
      <label>트랩 길이(mm) <input id="trapLen" type="number" min="0" value="200"></label>
    </div>

    <div id="dynamicLengths" class="card" style="margin-top:10px">
      <div class="row"><b>④ 각 배관 구간 길이(mm)</b> <span class="muted">배관 개수만큼 자동 생성</span></div>
      <div id="pipeInputs" class="grid3"></div>
      <div id="sumInfo" class="muted"></div>
    </div>

    <div class="row">
      <label><b>⑤ 방향</b></label>
      <select id="direction">
        <option value="right">→</option>
        <option value="left">←</option>
        <option value="up">↑</option>
        <option value="down">↓</option>
      </select>
      <label><b>재질</b></label>
      <select id="material">
        <option>CS</option><option>SS304</option><option>SS316</option>
      </select>
      <label><b>크기</b></label>
      <select id="size">
        <option>1"</option><option>2"</option><option>3"</option><option>4"</option><option>6"</option>
      </select>
      <label><b>스케줄</b></label>
      <select id="schedule">
        <option>40</option><option selected>80</option><option>160</option>
      </select>
    </div>

    <div class="row">
      <label><b>⑥ 설비 정보</b></label>
      <input id="equipName" placeholder="설비명" style="min-width:200px">
      <input id="equipLoc" placeholder="설비위치" style="min-width:200px">
    </div>
    <div class="muted">※ 숫자는 전부 mm 기준. 병렬은 두 라인으로 자동 분배해서 그립니다.</div>
  </section>

  <section class="card">
    <div class="bar">
      <div class="titleblock" id="titleTop">설비위치  설비명</div>
      <div class="titleblock" id="titleMid">재질  크기  스케쥴</div>
      <div class="titleblock" id="titleDir">방향: →</div>
    </div>
    <svg id="svg" viewBox="0 0 1600 1000"></svg>
    <div class="row">
      <div class="muted" id="lengthSummary">총 길이: -</div>
    </div>
  </section>
</main>

<script src="app.js"></script>
<script>
if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js'); }
</script>
</body>
</html>
